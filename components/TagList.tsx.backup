import Link from '@/components/Link'
import Tag from '@/components/Tag'
import { slug } from 'github-slugger'
import { getPublishedTags } from '../utils/tagUtils'

export default function TagList() {
  const { tagCounts, publishedCount, totalCount } = getPublishedTags()

  const sortedTags = Object.entries(tagCounts)
    .sort((a, b) => b[1] - a[1])
    .map(([tag, count]) => ({ tag, count }))

  return (
    <div>
      <p className="hidden">
        Total posts: {totalCount}, Published posts: {publishedCount}
      </p>
      <ul className="flex flex-wrap gap-2">
        {sortedTags.map(({ tag, count }) => (
          <li
            key={tag}
            className="mb-2 flex rounded-md bg-gradient-to-br from-[#F3F2F5] to-[#EEEEEE]"
          >
            <Link
              href={`/tags/${slug(tag)}`}
              className="px-3 py-2 text-sm font-medium uppercase text-gray-500 hover:text-primary-500"
              aria-label={`Ver publicaciones etiquetadas ${tag}`}
            >
              {tag} ({count})
            </Link>
          </li>
        ))}
      </ul>
    </div>
  )
}
