import Link from '@/components/Link'
import Tag from '@/components/Tag'
import Image from 'next/image'
import { CoreContent } from 'pliny/utils/contentlayer'
import type { Blog } from 'contentlayer/generated'

type PostContent = CoreContent<Blog> & { image?: string }

function formatDateSpanish(date: string) {
  return new Intl.DateTimeFormat('es-ES', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  }).format(new Date(date))
}

export default function ClientSidePostList({ posts }: { posts: PostContent[] }) {
  return (
    <ul className="m-4 grid grid-cols-1 gap-4 md:m-0 ">
      {posts.map((post) => {
        const { path, date, title, summary, tags, image } = post
        return (
          <li
            key={path}
            className="rounded-md bg-white px-5 py-8 shadow-sm transition-all duration-300 hover:shadow-md"
          >
            <article className="flex flex-col space-y-2 xl:space-y-0">
              <Link href={`/${path}`} className="flex flex-col gap-6 md:flex-row">
                {image && (
                  <div className="mb-4 flex-[2] overflow-hidden rounded-md">
                    <Image
                      src={image}
                      alt={title}
                      width={500}
                      height={300}
                      className="object-cover transition-transform duration-300 hover:scale-105"
                    />
                  </div>
                )}

                <div className="flex-[6] space-y-3">
                  <div>
                    <h2 className="text-2xl font-semibold leading-8 tracking-tight">{title}</h2>
                  </div>
                  <div className="prose max-w-none text-lg text-[#434343] ">{summary}</div>
                  <dl>
                    <dt className="sr-only">Publicado el {formatDateSpanish(date)}</dt>
                    <dd className="mb-2 text-base font-medium leading-6 text-gray-500">
                      <time dateTime={date}>{formatDateSpanish(date)}</time>
                    </dd>
                  </dl>
                  <div className="flex flex-wrap">
                    {tags?.map((tag) => <Tag key={tag} text={tag} />)}
                  </div>
                </div>
              </Link>
            </article>
          </li>
        )
      })}
    </ul>
  )
}
